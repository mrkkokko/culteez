!function(e){let t=e.document;MoveWindow=function(e){if(1!==e.buttons)return;let i=this.parentElement.parentElement,n=e.clientX-i.offsetLeft,o=e.clientY-i.offsetTop;move=function(e){i.style.left=e.clientX-n+"px",i.style.top=e.clientY-o+"px",i.style.cursor="move"},FrontWindow(i),halt=function(e){t.removeEventListener("mousemove",move),t.removeEventListener("mouseup",halt),i.style.cursor="default"},t.addEventListener("mouseup",halt),t.addEventListener("mousemove",move)},ResizeWindow=function(e){if(1!==e.buttons)return;let i=this.parentElement.parentElement,n=e.clientX-i.clientWidth,o=e.clientY-i.clientHeight;resize=function(e){i.style.width=e.clientX-n+"px",i.style.height=e.clientY-o+"px"},FrontWindow(i),halt=function(){t.removeEventListener("mousemove",resize),t.removeEventListener("mouseup",halt)},t.addEventListener("mouseup",halt),t.addEventListener("mousemove",resize)},MinimizeWindow=function(e){e.parentElement.parentElement.classList.toggle("minimized")},KillWindow=function(e){let t=e.parentElement.parentElement;t.classList.add("closed"),t.classList.remove("minimized")},FrontWindow=function(e){$(".window").forEach(e=>e.classList.remove("frontmost")),e.parentNode.appendChild(e),e.classList.add("frontmost")},MoveFile=function(e){if(1!==e.buttons)return;let i,o=this.parentElement,r=e.clientX-o.offsetLeft,a=e.clientY-o.offsetTop;down=function(){i=setTimeout(()=>{t.addEventListener("mousemove",move),o.classList.add("dragging"),t.removeEventListener("mousedown",down)},200)},move=function(e){o.style.left=e.clientX-r+"px",o.style.top=e.clientY-a+"px",o.style.cursor="move"},halt=function(e){clearTimeout(i),o.classList.contains("dragging")&&o.getAttribute("window")!=n.parentNode.parentNode.getAttribute("window")&&n.appendChild(o),o.classList.remove("dragging"),o.style.cursor="default",t.removeEventListener("mousedown",down),t.removeEventListener("mousemove",move),t.removeEventListener("mouseup",halt)},t.addEventListener("mousedown",down),t.addEventListener("mouseup",halt)};let i={};i.Window=class e{id="generic";name="Journal";is=!0;settings=[1,1,1,1,0];fore={};subject;Summon(){0==$('.window[window="'+this.id+'"]').length&&(this.fore.window=jC.DOM('div.window[window="'+this.id+'"].closed',$("#desktop")[0]),this.fore.header=jC.DOM("div.header",this.fore.window),this.fore.mainer=jC.DOM("div.mainer",this.fore.window),this.fore.footer=jC.DOM("div.footer",this.fore.window),this.fore.title=jC.DOM("p.title",this.fore.header),this.fore.title.innerText=this.name,this.settings[0]&&this.fore.title.addEventListener("mousedown",MoveWindow),this.fore.minimizer=jC.DOM("p"+(this.settings[1]?".minimizer":""),this.fore.header),this.fore.killer=jC.DOM("p"+(this.settings[2]?".killer":""),this.fore.header),this.fore.content=jC.DOM("div.content"+(this.settings[4]?".folder":""),this.fore.mainer),this.fore.content.innerHTML=this.subject instanceof Element?this.subject.outerHTML:this.subject?this.subject:"",this.fore.resizer=jC.DOM("p"+(this.settings[3]?".resizer":""),this.fore.footer),this.settings[3]&&this.fore.resizer.addEventListener("mousedown",ResizeWindow))}Erase(){$("#desktop")[0].removeChild(this.fore.window)}Realize(){this.Erase(),this.Summon()}Relocate(e,t){e=String(e),t=String(t),this.fore.window.style.left=e,this.fore.window.style.top=t}Resize(e,t){e=String(e),t=String(t),this.fore.window.style.width=e,this.fore.window.style.height=t}constructor(e,t,i,n){this.id=e||this.id,this.name=t||this.name,this.is=i||this.is,this.settings=n||this.settings,this.Summon()}},i.File=class e{id="generic";name="Writ";icon="default.png";is=!0;settings=[1,1,1,1,0];hith={};hither;Summon(){0==$('.file[window="'+this.id+'"]').length&&(this.hith.file=jC.DOM('div.file[window="'+this.id+'"]',$("#desktop")[0]),this.hith.icon=jC.DOM("img[src=assets/icons/"+this.icon+"]",this.hith.file),this.hith.name=jC.DOM("p",this.hith.file),this.hith.name.innerText=this.name,this.hith.icon.addEventListener("mousedown",MoveFile))}Erase(){this.hith.file.parentNode.removeChild(this.hith.file)}Realize(){this.Erase(),this.Summon(),this.hither.Realize()}Transfer(e){(e=e||$("#desktop")[0]).appendChild(this.hith.file)}constructor(e,t,n,o,r){this.id=e||this.id,this.name=t||this.name,this.icon=n||this.icon,this.is=o||this.is,this.settings=r||this.settings,this.hither=new i.Window(this.id,this.name,this.is,this.settings),this.Summon()}},i.Menu=class e{id="context";name="Menu";open=!1;root={};actions={};Spawn(e,t){for(let i in o.open&&o.Delete(),e=Number(e)||0,t=Number(t)||0,this.root=jC.DOM("div.menu",$("#desktop")[0]),this.root.classList.remove("empty"),0==Object.keys(o.actions).length&&this.root.classList.add("empty"),this.root.style.left=e+"px",this.root.style.top=t+"px",this.actions){let n=jC.DOM("button.action",this.root);n.innerText=i,n.addEventListener("click",this.actions[i])}this.open=!0}Delete(){$("#desktop")[0].removeChild(this.root),this.open=!1,this.root.classList.remove("empty")}},i.Game=class e{version="v0.1";E={};localSave};let n;t.onmouseover=function(e){let t=e.target;for(;t!=this;){if(t.classList.contains("folder")||"desktop"==t.id){n=t;break}t=t.parentNode}},t.onclick=function(e){let t=e.target;if(t.classList.contains("killer")){KillWindow(t);return}for(t.classList.contains("minimizer")&&MinimizeWindow(t);t!=this;){if(t.classList.contains("window")){FrontWindow(t);return}if(["INPUT","TEXTAREA"].includes(t.tagName)||t.classList.contains("menu"))return;t=t.parentNode}o.open&&o.Delete(),e.preventDefault()},t.ondblclick=function(e){let t=e.target;for(;t!=this;)t.classList.contains("file")&&$(".window").forEach(e=>{if(e.getAttribute("window")==t.getAttribute("window")){e.classList.remove("closed"),e.classList.remove("minimized"),FrontWindow(e);return}}),t=t.parentNode;e.preventDefault()},e.Game=new i.Game,Game.E={characterWindow:new i.File("character","Kind","character.png",!0,[1,1,1,0,0]),fundingsWindow:new i.File("fundings","Funds","document.png",!0,[1,1,1,0,0]),explorationWindow:new i.File("exploration","Inquiry","exploration.png")},Game.E.characterWindow.hither.subject='<div class="playerstats"><span id="origin">TAGCTAGCTAGCTAGC</span><hr><span id="acrobacy">4</span><span id="vitality">4</span><span id="calculus">4</span><span id="judgment">4</span><hr><span id="health">4/4</span><span id="sanity">4/4</span></div>',Game.E.characterWindow.hither.Realize(),Game.E.characterWindow.hither.Resize("200px","300px"),Game.E.fundingsWindow.hither.subject='<div class="playerfunds"><hr class="money"/><span id="funds">1.22</span><hr class="cult"/><span id="followers">12</span><span id="offerings">2</span></div>',Game.E.fundingsWindow.hither.Realize(),Game.E.fundingsWindow.hither.Resize("140px","230px");let o=new i.Menu;t.oncontextmenu=function(e){if(e.preventDefault(),0!==e.buttons)return;let t=e.target;for(o.actions={};t!=this;){if(t.classList.contains("menu"))return;if(t.classList.contains("file")){let i=t.getAttribute("window");o.actions.Hide=function(){let e=$('div[window="'+i+'"]');for(s of e)s.parentNode.removeChild(s);o.Delete()}}o.actions.Reset=function(){for(g in Game.E)Game.E[g].active&&Game.E[g].Spawn();o.Delete()},t=t.parentNode}o.Spawn(e.clientX,e.clientY)}}(self);