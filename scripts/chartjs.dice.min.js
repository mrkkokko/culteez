!function(W){var hyper=/\d*d\d+(?:d\d+)*/g,Dice=function(t,e){t=~~t,e=~~e;let r=[],n;for(n=0;n<t;n++)r.push(jC.rng(e));return r},Sar=function(t){t="Array"==jC.type(t)?t:[];let e=0,r;for(r=0;r<t.length;r++)e+=t[r];return e},Hyper=function(t){t=jC.despace(t);let e=0,r;if(t.startsWith("d"))for(r=0,e=(t=t.match(/\d+/g)).length;r<e;r++)t[r]=Sar(Dice(r?t[r-1]:1,t[r]));else for(r=0,e=(t=t.match(/\d+/g)).length;r<e;r++)t[r]=Sar(r?Dice(t[r-1],t[r]):Dice(t[r],1));return t[e-1]},Parse=function(e){let h=e.match(hyper)||[],i;for(i=0;i<h.length;i++)h[i]=Hyper(h[i]);return i=-1,e=e.replace(hyper,function(){return h[++i]}),eval(e)};W.Roll=function(t,e){if(t=t||"d6","string"!=jC.type(t)){jC.log("Error: given argument is not a string;");return}t=jC.despace(t.toLowerCase()),e=~~e||1;let r=[],n;for(n=0;n<e;n++)r.push(Parse(t));return r},W.Dice=class Dice{result=3;expression="d6";Reroll(){this.result=Number(Roll(this.expression))}constructor(t){t="undefined"==jC.type(t)?"d6":String(t),this.expression=t,this.Reroll()}}}(self);